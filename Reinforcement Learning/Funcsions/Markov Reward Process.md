마르코프 보상 프로세스(Markov Reward Process)는 <font color="#ffff00">마르코프 프로세스에서 각 상태마다 좋고 나쁨(reward)이 추가된 확률 모델</font>입니다. 다음 그림과 같이 상태 $s$ 에서 $s'$ 으로 이동했을때 이동 결과가 좋고 나쁨에 대한 보상(혹은 벌칙)을 주는 것이 마르코프 보상 프로세스입니다.

![[Pasted image 20231031171150.png]]

이때 각 상태의 보상 종합을<font color="#00b050"> 리턴(return)</font> 이라고 하며, 다음과 같이 표현됩니다.

![[Pasted image 20231031171723.png]]
하지만 상태의 정확한 가치를 구하기 위해서는 어느 시점에서 보상을 받을지가 중요합니다. 즉, <font color="#ffff00">특정 상태에 빨리 도달해서 즉시 보상을 받을 것인지 아니면 나중에 도달해서 보상을 받을 것인지</font> 에 대한 가치 판단이 필요합니다. 예를 들어 $A$ 가 $B$ 에게 돈을 빌려주면, $A$ 는 원금과 이자를 합산하여 돌려 받습니다. 이때 이자는 현재 가치와 미래 가치를 판단하게 해 주는 척도입니다.

(현재 가치) 에 (이자: 현재 가치 x 이자율)을 더하면 (미래 가치)가 됩니다. 그렇다면 (현재 가치) 와 (미래 가치)를 비교한다면 (현재 가치) < (미래 가치)가 성립할까요? (현재 가치)와 (미래 가치)를 비교하기 위해서는 시간 개념이 필요합니다. (현재 가치)는 $t$ 시간이고 (미래 가치)는 $t$ 보다 더 미래의 시간입니다. 미래 가치는 $t$ 시간이 충분히 시간이 지나고, 그에 따른 이자가 붙어야만 현재 가치와 동일해집니다. 즉, <font color="#ffff00">미래 가치를 현재 시점으로 보면 현재 가치보다 적은 것입니다</font>. 이를 수식적으로 반영한 것을 <font color="#00b050">할인율(discounting factor</font>, $\gamma$) 입니다. 보통 $\gamma$ 는 0과 1 사이의 값으로 하여 <font color="#ffff00">미래 가치를 현재 시점에서의 가치로 변환</font>합니다.

그리고 미래에 받게 될 보상들이 모두 0이 되면, 바로 다음의 보상만 추구하는 근시안적인 행동을 하게 될 것입니다. 반대로 할인율이 1과 가까워질수록 미래 보상에 대한 할인이 적어지기 때문에 미래 보상들을 더 많이 고려하게 되는 원시안적인 행동을 하게 됩니다.

따라서 할인율이 적용된 리턴($G_t$)은 다음 수식을 사용합니다.

$$G_t = r_{t+1} + \gamma r_{t+2} + \gamma^2r_{t+3} + \dots = \Sigma^{\infty}_{k=1}\gamma^kr_{t+k+1}$$

추가적으로 <font color="#00b050">가치 함수(value function)</font>에 대한 이해도 필요합니다. 현재 상태가 $s$ 일 때 <font color="#ffff00">앞으로 발생할 것으로 기대되는</font>($E$) <font color="#ffff00">모든 보상의 합</font>을 <font color="#00b050">가치(value</font>) 라고합니다. 이것을 수학적으로 표현하면 다음과 같습니다.
$$v(s) = E[G_t | S_t = s]$$
즉, 가치 함수는 현재 시점에서 미래의 모든 기대되는 보상을 표현하는 미래 가치라고 할 수 있습니다. 따라서 [[Reinforcement Learning]] 의 핵심은 <font color="#ffff00">가치 함수를 최대한 정확하게 찾는 것</font>입니다. 다시 말해 밀 가치가 가장 클 것으로 기대되는 결정을 하고 행동하는 것이 강화 학습의 목표라고 할 수 있습니다.

그러면 병원을 방문한 어느 하루에 대한 마르코프 프로세스에 보상을 추가해 보겠습니다.
![[Pasted image 20231031174323.png]]

예제에서 $\gamma=0$ 일 때 <font color="#ffc000">웹 서핑</font> 에 대한 가치(value) 값을 -2.4로, <font color="#ffc000">진찰</font>에 대한 가치 값을 1.2로 가정하면 <font color="#ffc000">독서</font>와 <font color="#ffc000">대기</font>에 대한 가치는 다음과 같이 구할 수 있습니다.

- <font color="#ffc000">독서</font> = $10 + \gamma \cdot [(-2.4 \cdot 0.3) + (0 \cdot 0.7)] = 10$
- <font color="#ffc000">대기</font> = $-2 + \gamma \cdot [(-2.4 \cdot 0.1) + (1.2 \cdot 0.8)] = -2$
