TrainingArguments λ” [[HuggingFaceπ¤—]] μ [[transformers]] λΌμ΄λΈλ¬λ¦¬μ—μ„ <font color="#ffff00">λ¨λΈ ν›λ ¨μ— ν•„μ”ν• λ§¤κ°λ³€μμ™€ μ„¤μ •μ„ μ μ–΄ν•λ” ν΄λμ¤</font>μ…λ‹λ‹¤. μ΄ ν΄λμ¤λ¥Ό μ‚¬μ©ν•μ—¬ training loop λ° ν™κ²½ μ„¤μ •μ„ κµ¬μ„±ν•  μ μμµλ‹λ‹¤. μ•„λλ” μ£Όμ” λ§¤κ°λ³€μμ— λ€ν• μ„¤λ…μ…λ‹λ‹¤.

> output_dir -> str
- λ¨λΈμ κ²°κ³Όμ™€ μ²΄ν¬ν¬μΈνΈκ°€ μ €μ¥λλ” κ²½λ΅λ¥Ό μ„¤μ •ν•©λ‹λ‹¤.

> learning_rate -> float, (optional), Default : 5e-5
- [[AdamW]] μµν‹°λ§μ΄μ €μ— μ‚¬μ©λλ” μ΄κΈ° ν•™μµλ¥ μ…λ‹λ‹¤.

> per_device_train_batch_size -> int, (optional), Default : 8
- ν›λ ¨ μ‹ GPU λλ” CPUμ— μ‚¬μ©λλ” λ°°μΉμ‚¬μ΄μ¦μ…λ‹λ‹¤.

> per_device_eval_batch_size -> int, (optional), Default : 8
- ν‰κ°€ μ‹ GPU λλ” CPUμ— μ‚¬μ©λλ” λ°°μΉμ‚¬μ΄μ¦μ…λ‹λ‹¤.

> num_train_epochs -> float, (optional), Default : 3.0
- μ΄ ν•™μµ μ—ν¬ν¬ μμ…λ‹λ‹¤. int ν•μ‹μ΄ μ•„λ‹ μ‹, ν•™μµμ΄ μΆ…λ£λκΈ° μ „ λ§μ§€λ§‰ μ—ν¬ν¬μ μ†μ«μ  μ΄ν• λ°±λ¶„μ¨λ΅ ν‘μ‹λ©λ‹λ‹¤.

> weight_decay -> float, (optional), Default : 0
- 0μ΄ μ•„λ‹ μ‹, λ°”μ΄μ–΄μ¤μ™€ [[AdamW]] μµν‹°λ§μ΄μ €μ— μ‚¬μ©λλ” LayerNorm μ— μ‚¬μ©λλ” κ°€μ¤‘μΉλ¥Ό μ μ™Έν• λ¨λ“  λ μ΄μ–΄μ— weight decayλ¥Ό μ μ©ν•©λ‹λ‹¤.

> evaluation_strategy -> str, (optional), Default : "no"
- ν›λ ¨ μ¤‘μ— μ‚¬μ©ν•  evaluation strategy μ…λ‹λ‹¤. μ‚¬μ©κ°€λ¥ν• κ°’μΌλ΅λ”
- "no" : ν›λ ¨ μ¤‘ ν‰κ°€λ¥Ό μν–‰ν•μ§€ μ•μµλ‹λ‹¤.
- "strps" : eval_steps λ§λ‹¤ ν‰κ°€ν•©λ‹λ‹¤.
- "epoch" : 1μ—ν¬ν¬λ§λ‹¤ ν‰κ°€ν•©λ‹λ‹¤.

> do_train -> bool, (optional), Default: False
- ν•™μµ μ—¬λ¶€λ¥Ό κ²°μ •γ…λ” νλΌλ―Έν„°μ…λ‹λ‹¤.
- κΈ°λ³Έκ°’μ€ `False` μ΄λ©°, ν•™μµμ„ μν–‰ν•μ§€ μ•μµλ‹λ‹¤.
- μ΄ νλΌλ―Έν„°λ” [[Trainer]] μ— μ§μ ‘μ μΌλ΅ μ‚¬μ©λμ§€ μ•κ³ , ν•™μµ/ν‰κ°€ μ¤ν¬λ¦½νΈμ—μ„ μ‚¬μ©λ©λ‹λ‹¤.

> do_eval -> bool, (optional)
- κ²€μ¦ μ„ΈνΈμ— λ€ν• ν‰κ°€ μ—¬λ¶€λ¥Ό κ²°μ •ν•λ” νλΌλ―Έν„°μ…λ‹λ‹¤.
- `evaluation_strategy` κ°€ `no` κ°€ μ•„λ‹ κ²½μ°, κΈ°λ³Έμ μΌλ΅ `True`λ΅ μ„¤μ •λ©λ‹λ‹¤.
- μ΄ νλΌλ―Έν„°λ” [[Trainer]] μ— μ§μ ‘μ μΌλ΅ μ‚¬μ©λμ§€ μ•κ³ , ν•™μµ/ν‰κ°€ μ¤ν¬λ¦½νΈμ—μ„ μ‚¬μ©λ©λ‹λ‹¤.

> do_predict -> bool, (optional), Default: False
- ν…μ¤νΈ μ„ΈνΈμ— λ€ν• μμΈ΅ μ—¬λ¶€λ¥Ό κ²°μ •ν•λ” νλΌλ―Έν„°μ…λ‹λ‹¤.
- κΈ°λ³Έκ°’μ€ `False` μ΄λ©°, μμΈ΅μ„ μν–‰ν•μ§€ μ•μµλ‹λ‹¤.
- μ΄ νλΌλ―Έν„°λ” [[Trainer]] μ— μ§μ ‘μ μΌλ΅ μ‚¬μ©λμ§€ μ•κ³ , ν•™μµ/ν‰κ°€ μ¤ν¬λ¦½νΈμ—μ„ μ‚¬μ©λ©λ‹λ‹¤.

> save_safetensors -> bool, (optional), Default : True
- μ΄ νλΌλ―Έν„°λ¥Ό ν†µν•΄ λ¨λΈμ μƒνƒλ¥Ό μ €μ¥ν•κ³  λ΅λ“ν•  λ–„ κΈ°λ³Έμ μΌλ΅ μ κ³µλλ” `torch.load` λ° `torch.save` λ€μ‹ μ— SafeTensorsλ¥Ό μ‚¬μ©ν• μ§€ μ—¬λ¶€λ¥Ό μ„¤μ •ν•  μ μμµλ‹λ‹¤.

> use_cpu -> bool, (optional), Default : False
- CPU μ‚¬μ© μ—¬λ¶€λ¥Ό κ²°μ •ν•λ” νλΌλ―Έν„°μ…λ‹λ‹¤.
- κΈ°λ³Έκ°’μ€ `False` μ΄λ©°, CUDA λλ” MPS μ¥μΉκ°€ μ‚¬μ©κ°€λ¥ν• κ²½μ°μ—λ” ν•΄λ‹Ή μ¥μΉλ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.
- λ§μ•½ `use_cpu` λ¥Ό `True` λ΅ μ„¤μ •ν•λ©΄ CPUλ¥Ό μ‚¬μ©ν•μ—¬ λ¨λΈμ„ ν•™μµν•κ² λ©λ‹λ‹¤.
- μ£Όλ΅ CUDAλ¥Ό μ‚¬μ©ν•  μ μ—†λ” ν™κ²½μ΄κ±°λ‚, λ³‘λ ¬μ²λ¦¬λ¥Ό μ§€μ›ν•μ§€ μ•λ” ν™κ²½μ—μ„ λ¨λΈμ„ μ‹¤ν–‰ν• λ• μ‚¬μ©λ©λ‹λ‹¤.

> seed -> int, (optional), Default : 42
- ν•™μµμ„ μ‹μ‘ν•  λ• μ„¤μ •ν•  λ‚μ μ‹λ“μ…λ‹λ‹¤.
- κΈ°λ³Έκ°’μ€ 42μ…λ‹λ‹¤.
- λ™μΌν• μ‹λ“λ¥Ό μ‚¬μ©ν•λ©΄ ν•™μµ κ³Όμ •μ—μ„ μ¬ν„ κ°€λ¥ν• κ²°κ³Όλ¥Ό μ–»μ„ μ μμµλ‹λ‹¤.

> data_seed -> int, (optional)
- λ°μ΄ν„° μƒν”λ¬(data sampler)μ— μ‚¬μ©ν•  λ‚μ μ‹λ“μ…λ‹λ‹¤.
- μ΄ νλΌλ―Έν„°κ°€ μ„¤μ •λμ§€ μ•μΌλ©΄, λ°μ΄ν„° μƒν”λ§μ— λ€ν• λ‚μλ” `seed` μ™€ λ™μΌν• μ‹λ“λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.
- λ¨λΈμ μ‹λ“μ™€ λ…λ¦½μ μΌλ΅ λ°μ΄ν„° μƒν”λ§μ μ¬ν„μ„±μ„ λ³΄μ¥ν•κΈ° μ„ν•΄ μ‚¬μ©λ©λ‹λ‹¤.

> optim -> str, (optional), Default : "adamw_torch"
- μµν‹°λ§μ΄μ €λ¥Ό μ§€μ •ν•λ”λ° μ‚¬μ©λλ” λ§¤κ°λ³€μμ…λ‹λ‹¤. μΆ…λ¥λ” μ•„λμ™€ κ°™μµλ‹λ‹¤.
- <font color="#ffff00">adamw_torch</font> : [[HuggingFaceπ¤—]] μ AdamW μµν‹°λ§μ΄μ €μ…λ‹λ‹¤.
- <font color="#ffff00"> adamw_torch</font> : [[Pytorch]] μ AdamW μµν‹°λ§μ΄μ €μ…λ‹λ‹¤.
- <font color="#ffff00">adamw_torch_fused</font> : [[Pytorch]] μ Fused AdamW μµν‹°λ§μ΄μ €μ…λ‹λ‹¤.
- <font color="#ffff00">adamw_apex_fused</font> : NVIDIA Apexμ Fused AdamW μµν‹°λ§μ΄μ €μ…λ‹λ‹¤.
- <font color="#ffff00">adamw_anyprecision</font> : λ‹¤μ–‘ν• μ •λ°€λ„λ¥Ό μ§€μ›ν•λ” AdamW μµν‹°λ§μ΄μ €μ…λ‹λ‹¤.
- <font color="#ffff00">adafactor</font> : AdaFactor μµν‹°λ§μ΄μ €μ…λ‹λ‹¤.

> gradient_accumulation_steps -> int, (optional), defaults to 1
- ν• λ²μ μ—­μ „ν λ° κ°€μ¤‘μΉ μ—…λ°μ΄νΈλ¥Ό μν–‰ν•κΈ° μ „μ— gradientλ¥Ό λ„μ ν•λ”λ° μ‚¬μ©λ©λ‹λ‹¤.
- μλ¥Ό λ“¤μ–΄, gradient_accumulation_stepsκ°€ 2λ΅ μ„¤μ •λμ–΄ μλ‹¤λ©΄, λ‘ λ²μ μμ „ν λ° μ—­μ „νκ°€ μ΄λ£¨μ–΄μ§„ ν›„μ— gradientκ°€ μ—…λ°μ΄νΈλ©λ‹λ‹¤. μ΄λ ‡κ² ν•λ©΄ **λ©”λ¨λ¦¬ μ‚¬μ©λ‰μ΄ μ¤„μ–΄λ“¤κ³ , λ” ν° λ°°μΉ ν¬κΈ°λ¥Ό μ‚¬μ©ν•  μ μμΌλ©°, ν›λ ¨ μ†λ„λ¥Ό μ΅°μ ν•  μ μμµλ‹λ‹¤.**
- μλ¥Ό λ“¤μ–΄ `batch_size = 8` λ€μ‹  `batch_size = 2` λ¥Ό μ‚¬μ©ν•κ³  `gradient_accumulation_steps = 4` λ΅ μ„¤μ •ν•λ©΄ μ•„λμ™€ κ°™μ€ stepsλ¥Ό λ”°λ¥΄κ² λ©λ‹λ‹¤.
```
μ²« λ²μ§Έ λ°°μΉλ¥Ό μ…λ ¥μΌλ΅ μ‚¬μ©ν•μ—¬ μμ „νλ¥Ό μν–‰ν•©λ‹λ‹¤.
κ·ΈλΌλ””μ–ΈνΈλ¥Ό κ³„μ‚°ν•κ³  μ΄λ¥Ό λ„μ ν•©λ‹λ‹¤.
λ‘ λ²μ§Έ λ°°μΉλ¥Ό μ…λ ¥μΌλ΅ μ‚¬μ©ν•μ—¬ μμ „νλ¥Ό μν–‰ν•©λ‹λ‹¤.
κ·ΈλΌλ””μ–ΈνΈλ¥Ό κ³„μ‚°ν•κ³  μ΄λ¥Ό λ„μ ν•©λ‹λ‹¤.
μ„Έ λ²μ§Έ λ°°μΉλ¥Ό μ…λ ¥μΌλ΅ μ‚¬μ©ν•μ—¬ μμ „νλ¥Ό μν–‰ν•©λ‹λ‹¤.
κ·ΈλΌλ””μ–ΈνΈλ¥Ό κ³„μ‚°ν•κ³  μ΄λ¥Ό λ„μ ν•©λ‹λ‹¤.
λ„¤ λ²μ§Έ λ°°μΉλ¥Ό μ…λ ¥μΌλ΅ μ‚¬μ©ν•μ—¬ μμ „νλ¥Ό μν–‰ν•©λ‹λ‹¤.
κ·ΈλΌλ””μ–ΈνΈλ¥Ό κ³„μ‚°ν•κ³  μ΄λ¥Ό λ„μ ν•©λ‹λ‹¤.
μ΄ 4λ²μ λ°°μΉλ¥Ό μ²λ¦¬ν• ν›„, μ—­μ „ν λ° κ°€μ¤‘μΉ μ—…λ°μ΄νΈλ¥Ό μν–‰ν•©λ‹λ‹¤.
```

