
## 미분

### 인공지능에서 미분의 필요성

미분을 시작하기에 앞서 인공지능에서 미분이 왜 필요한지 알아봅시다.

인공지능에서 미분은 [[Backward propagation]] 에서 활용됩니다. 정확히는 가중치와 편향의 값을 조절할 때 사용하는데, 용어부터 알아봅시다.

![[Pasted image 20240228155116.png]]

- <font color="#00b050">입력층(input)</font> : 데이터가 입력되는 계층입니다.
- <font color="#00b050">은닉층(hidden)</font> : 입력층과 출력층 사이에 위치하여 복잡한 분류 문제에서 판별 경계를 찾는 데 사용합니다.
- <font color="#00b050">출력층(output)</font> : 활성화 함수 값을 계산하여 출력을 결정합니다.
- <font color="#00b050">가중치(weight)</font> : 각 신호가 결과에 주는 영향력을 조절하는 요소로 가중치가 클수록 해당 신호가 그만큼 더 중요하다는 의미입니다.
- <font color="#00b050">가중합(weighted sum)</font> : 입력 값($x$) 과 가중치($w$) 의 곱을 모두 더한 후 그 값에 편향($b$) 를 더한 값입니다.
$$y = wx + b$$
- <font color="#00b050">편향(bias)</font> : 가중합에 더하는 상수로, 하나의 뉴런에서 활성화 함수를 거쳐 최종으로 출력되는 값을 조절하는 역할을 합니다.
- <font color="#00b050">활성화 함수</font>([[Activation]] function) 가중합의 결과를 놓고 1 또는 0을 출력해서 다음 뉴런으로 보내는데, 이때 0과 1을 판단하는 함수가 활성화 함수입니다. 활성화 함수로는 [[Sigmoid]]  [[ReLU]] 등이 있습니다.

용어에 익숙해졌다면 미분과 인공지능 관계를 알아봅시다.

위 그림에서 각 원(뉴런)의 값을 구하려면 입력 데이터, 가중치, 편향, 활성화 함수만 알면 됩니다. 입력 데이터는 이밎 알고 활성화 함수도 가중합으로 알 수 있는 값이기 때문에 가중치($w$) 와 편향($b$) 만 구하면 됩니다.

그렇다면 가중치와 편향은 어떻게 구할까요? 가중치와 편향은 역전파로 구하는데, 이때 미분을 사용합니다.

위 그림에서 임의의 가중치와 편향을 선택했을 때, 출력 값과 정답의 차이가 4였다고 가정합니다. (실제로는 MSE 알고리즘을 통해 $(|출력 값 - 정답|^2)$) 으로 구해지지만 편의상 차이가 4라고 가정합니다. ) 이때 출력값과 정답의 차이가 0에 가까워지도록 가중치오 편향의 값을 계속 조정하기를 반복합니다.

구체적으로 수식 표현은 다음과 같습니다. 수식은 이해하지 못하더라도, 이러한 수식으로 가중치와 편향의 값이 조정된다는 정도만 알고 넘어갑시다.

---
만약 $w(i) \cdot x(i) > 0$ & $y(i) = -1$ 이면, $w(i+1) = w(i) - \eta(i) \cdot x(i)$ 

만약 $w(i) \cdot x(i) \leq 0$ & $y(i) = 1$ 이면, $w(i+1) = w(i) + \eta(i) \cdot x(i)$ 

- $x(i)$ : 입력 값
- $y(i)$ : 출력 값
- $w(i)$ : 현재 가중치
- $w(i+1)$ : $w(i)$ 의 업데이트 값
- $\eta(i)$ : 학습률($0 \leq \eta \leq 1$)
> 학습률 ( eta )
>한 번 학습할 때 얼만큼 변화를 주는지에 대한 상수로, 학습률 값에 따라 학습 정확도가 달라질 수 있으므로 인공지능에서 매우 중요한 값입니다.

즉, $i$ 번째 출력 값이 -1이고($y(i) = -1$), $i$ 번째 입력 값과 $i$ 번째 가중치를 곱한 값이 0보다 클 때($w(i) \cdot x(i) \gt 0$), 정답과 출력 값의 오차를 줄이려고(0을 만들려고) 현재 가중치 값에 학습률과 입력 값을 곱한 값을 빼면서 ($w(i) - \eta(i) \cdot x(i)$) 가중치를 업데이트합니다. 반대로 $i$ 번째 출력 값이 1이고($y(i) = 1$), $i$ 번째 입력 값과 $i$ 번째 가중치를 곱한 값이 0보다 작거나 같다고 가정할때는($w(i) \cdot w(i) \leq 0$), 현재 가중치 값에 학습률과 입력 값을 곱한 값을 더하면서($w(i) + \eta(i) \cdot x(i)$) 가중치를 업데이트합니다.

이러한 과정이 역전파이며, 미분은 $(출력 값 - 정답)^2$ 값을 가중치로 미분할 때 사용합니다. 즉, $w(i) - \eta(i) \cdot x(i)$ 를 $w(i)$ 로 미분하거나 $w(i) + \eta(i) \cdot x(i)$ 를 $w(i)$ 로 미분한 값이 $w(i + 1)$ 입니다.

인공지능에서 <font color="#00b050">학습</font>이란 <font color="#ffff00">신경망에서 원하는 결과를 얻기 위해 뉴런 사이의 적당한 가중치를 알아내는 것</font>, 즉 가중치를 최적화하는 것이라고 할 때 미부은 인공지능의 가중치 계산에서 핵심입니다. 

### 미분이란

미분의 학습 필요성에 충분히 공감했다면, 본격적으로 미분 학습을 시작합니다.

미분은 <font color="#ffff00">한 점에서의 기울기를 의미</font>합니다. (원래 미분은 두 점 사이의 기울기를 의미하지만, 두 점 사이의 거리가 0에 가까울 정도로 가까워서 한 점에서의 기울기라고 표현합니다.) 즉, $f(x)$ 라는 함수 위의 한 점 $(a, f(a))$ 에서의 기울기이며 $f'(a)$ 라고 씁니다.

$f'(a)$ 는 다음과 같이 의미가 다양합니다.

- $a$ 라는 점에서의 기울기
- $a$ 라는 점에서 접선의 기울기
- $a$ 라는 점에서의 미분 값
- $a$ 라는 점에서의 미분계수

미분을 그래프의 좌표로 표현하면 다음과 같습니다.

![[Pasted image 20240228164841.png]]

그림과 같이 함수 $f(x)$ 위에 $P(a, f(a))$ 라는 점이 있고, $a$ 에서 오른쪽과 위쪽으로 $h$ 만큼 움직인 $Q(a+h, f(a+h))$ 라는 두 점이 있을 때, 점 $P$ 와 $Q$ 사이의 기울기는 아래 수식처럼 표현할 수 있습니다.

$$기울기 = \frac{y의 증가량}{x의 증가량} = \frac{f(a+h) - f(a)}{(a+h) - a}$$

미분은 <font color="#ffff00">한 점에서의 기울기라고 정의</font>했습니다. 이때 **기울기** 의미에 주목해야 합니다. 기울기이기는 한데, $x$ 의 증가량이 0과 가까워질 때의 기울기입니다. 따라서 수식에서 $x$ 의 증가량이 $(a +h) - a$ 라고 표현했으므로 $a - a + h$ 가 되어, 결국 $x$ 의 증가량은 $h$ 가 됩니다. $h$ 를 0으로 보내면 아래 수식처럼 표현할 수 있습니다.

$$\lim_{h \rightarrow 0} = \frac{f(a + h) - f(a)}{(a+h) - a}$$

위 그림에서 점 $Q$ 가 점 $P$ 와 가까워진다면, 다음과 같이 기울기가 변하면서 결국 한 점 $P$ 에서의 기울기가 됩니다.

![[Pasted image 20240228170043.png]]

![[Pasted image 20240228170047.png]]
> x의 증가량을 0으로 보냈을 때 기울기의 변화

즉, 위 그림은 결국 $P$ 라는 점에서의 접선이 되었고, 이를 다시 표현하면 $x=a$ 라는 한 점에서 접선의 기울기가 되는 것입니다. 이를 식으로 정리하면 아래 수식과 같습니다.

$$\lim_{h \rightarrow0}\frac{f(a+h) - f(a)}{(a+h) - a} = f'(a)$$

> 접선
> 
> 접선은 곡선 위의 한 점에서 곡선에 접하는 직선을 이르는 말입니다.

![[Pasted image 20240228170432.png|256]]

## 함수의 극한(수렴과 발산)

### 함수의 극한(수렴)

아래 그림과 같이 함수 $f(x)$ 에서 $x$ 가 $a$ 와 다른 값($x \ne a$) 를 취하면서 $a$ 에 한없이 가까워질 때, 즉 $f(x)$ 값이 일정한 값 $b$ 에 한없이 가까워 진다면 함수 $f(x)$ 는 $b$ 에 **수렴한다** 고 합니다.
![[Pasted image 20240228170851.png]]

이때 $b$ 를 $x$ 값이 $a$ 에 한없이 가까워질 때 $f(x)$ 의 극한값 또는 극한이라고 하며, 다음과 같이 표현합니다.

$$x \rightarrow a일 때, f(x) \rightarrow b 또는 \lim_{x \rightarrow a}f(x) = b$$

여기에서 $x \rightarrow a$ 의미는 다음과 같습니다.

- $x$와 $a$ 가 같지 않다면 ($x \ne a$) $a$ 에 한없이 가까이 가는 상태를 의미합니다.
- 좌극한($x \rightarrow a - 0$) 과 우극한($x \rightarrow a + 0$) 두 경우를 묶어서 $x \rightarrow a$ 로 나타냅니다.

특히 <font color="#00b050">상수함수</font> $f(x) = c$ (c는 상수)는 모든 $x$ 값에 대해 항상 같은 값 $c$ 를 출력합니다. 따라서 $a$ 값에 관계없이 다음이 성립합니다.

$$\lim_{x \rightarrow a}f(x) = \lim_{x \rightarrow a}c = c$$

예를 들어 함수 $f(x) = \frac{x^2 - 1}{x - 1}$ 에서 $x=1$ 이면 분모가 0이 되므로 $x = 1$ 에서 함수 값 $f(1)$ 은 정의되지 않습니다. (그렇기 때문에 아래 그림에서 $f(1)$ 에서 구멍이 비어 있습니다.). 하지만 $x \ne 1$ 일 경우에는 $f(x) = \frac{x^2 - 1}{x -1} = \frac{(x+1)(x-1)}{x-1}$ = $(x+1)$ 이므로 $x$ 가 1이 아닌 값을 가지면서 1에 한없이 가까워지면 $f(x)$ 는 2에 가까워집니다.

![[Pasted image 20240228171607.png]]

### ∞, ‐∞ 에서 함수의 극한

함수 $f(x)$ 에서 $x$ 가 **양수**이면서 그 절댓값이 한없이 커질 때, 함수 $f(x)$ 값이 일정한 값 $a$ 에 한없이 가까워지면(수렴하면) 다음과 같이 나타냅니다.

$$\lim_{x \rightarrow \infty} f(x) = a$$

또한 $f(x)$ 에서 $x$ 가 **음수** 이면서 그 절댓값이 한없이 커질 때, 함수 $f(x)$ 값이 일정한 값 $a$ 에 한없이 가까워지면(수렴하면) 다음과 같이 나타냅니다.

$$\lim_{x \rightarrow -\infty}f(x) = a$$

예시로 $f(x) = \frac{2x-1}{x}$ 일때 $\lim_{x \rightarrow \infty}f(x)$ 를 구해보면

$$\lim_{x \rightarrow \infty}\frac{2x-1}{x} = \lim_{x \rightarrow \infty}\frac{2x}{x} - \lim_{x \rightarrow \infty}\frac{1}{x}$$

에서 $\lim_{x \rightarrow \infty}\frac{1}{x}$ 는 $x$ 가 매우 큰 값이라면, 상수 1은 $x$ 에 비해 상대적으로 무시할 수 있습니다.

여기서 첫 번째 항은 $x$ 가 무한대로 갈 때 2로 수렴하고, 두 번째 항은 $x$가 무한대로 갈때 0으로 수렴합니다. 따라서 전체 극한은 다음과 같습니다.

$$\lim_{x \rightarrow \infty}\frac{2x-1}{x} = 2-0 = 2$$

### 함수의 발산

함수의 바산이란 함수 $f(x)$ 에서 함수 값이 어떤 실수 값에 수렴하지 않고 무한히 커지는 것을 의미합니다. 함수의 발산에는 <font color="#00b050">양의 무한대 발산</font>과 <font color="#00b050">음의 무한대 발산</font>, <font color="#00b050">진동</font>이 있습니다.

**양의 무한대 발산**은 함수 $f(x)$ 에서 $x$ 값이 $a$ 에 한없이 가까워질때, $f(x)$ 값이 커지면 $f(x)$ 는 양의 무한대로 발산한다 하고 다음과 같이 나타냅니다.

$$x \rightarrow a 일때, f(x) \rightarrow \infty 또는 \lim_{x \rightarrow a}f(x) = \infty$$

**음의 무한대 발산**은 함수 $f(x)$ 에서 $x$ 값이 $a$ 에 한없이 가까워질때, $f(x)$ 값이 음수임ㄴ서 그 절댓값이 한없이 커지며 $f(x)$ 는 음의 무한대로 발산한다 하고 다음과 같이 나타냅니다.

$$x \rightarrow a 일때, f(x) \rightarrow -\infty 또는 \lim_{x \rightarrow a}f(x) = -\infty$$

예시에서 확인해 봅시다.

아래그림에서 $f(x) = \frac{1}{x}$ 그래프는 양의 무한대와 음의 무한대로 확장됩니다. $x$ 가 +0으로 한없이 가까워질때 $+\infty$ 가 되고, $x$ -0으로 한없이 가까워질 때 $-\infty$ 가 됩니다. 즉, 다음 결과를 도출할 수 있습니다.

![[Pasted image 20240229134952.png]]

하지만 +0과 -0에 대한 결과(극한)가 일치하지 않기 때문에 $x = 0$ 에서의 극한값은 존재하지 않습니다. 그렇다면 아래 그림에서 $f(x) = \frac{1}{|x|}$ 그래프는 어떨까요?

![[Pasted image 20240229135420.png]]

$x$ 가 +0으로 한없이 가까워질 때 $+\infty$ 가 되고, $x$ 가 -0으로 한없이 가까워질 때도 $+\infty$ 로 가까워집니다. 따라서 $\lim_{x \rightarrow 0}\frac{1}{|x|} = \infty$ 로 표현할 수 있습니다.

이때 극한값은 $\infty$ 라고 생각할 수 있지만, $\infty$ 가 아닙니다. <font color="#ffff00">극한값이란 수렴할 때의 값을 의미</font>하기 때문에 이 역시 수렴하지 않으므로 **극한값은 없다** 가 정답입니다. 하지만 기호로는 $\lim_{x \rightarrow 0}\frac{1}{|x|} = \infty$ 로 표현할 수 있습니다.

참고로 **함수의 진동** 은 <font color="#ffff00">극한으로 다가갈수록 끊임없이 진동하는 것</font>입니다.

![[Pasted image 20240229135923.png|512]]
> 함수의 진동


## 좌 우극한 및 극한값의 조건

---

### 함수의 좌극한과 우극한

함수의 좌극한과 우극한을 알아보기 전에 먼저 아래그림을 살펴봅시다. 다음은 $x$ 값이 3으로 가까워지는 두 가지 상태를 보여 줍니다.

![[Pasted image 20240229152519.png|512]]

> 3보다 크면서 3으로 다가오는 상태를 3+로 표시하고, 3보다 작으면서 3으로 다가오는 상태를 3-로 표현합니다.


함수 $f(x)$ 에서 $x$ 가 $a$ 보다 작으면서 $a$ 로 점점 가까워질 때, $f(x)$ 가 가까워지는 값이 있다면 이것을 점 $a$ 에서 함수의 <font color="#00b050">좌극한</font> 이라고 합니다.

![[Pasted image 20240229152838.png|512]]
>함수 f(x)의 좌극한


위 그림은 $y = f(x)$ 에서 $x$ 가 3보다 작은 값을 가지면서 3에 가까이 다가갑니다. 즉, $x \rightarrow 3-$ 일때 다음과 같이 표현할 수 있습니다.

$$\lim_{x \rightarrow 3-}f(x) = a$$
이때의 좌극한은 $a$ 입니다.

함수$f(x)$ 에서 $x$ 가 $a$ 보다 크면서 $a$ 로 점점 가까워질 때, $f(x)$ 가 가까워지는 값이 있다면 이것을 점 $a$ 에서 함수의 <font color="#00b050">우극한</font> 이라고 합니다.

![[Pasted image 20240229153122.png|512]]
> 함수 f(x)의 우극한

위 그림은 함수 $y = f(x)$ 에서 $x$ 가 3보다 큰 값을 가지면서 3에 가까이 다가갑니다. 즉, $x \rightarrow 3+$ 일때 다음과 같이 표현할 수 있습니다.

$$\lim_{x \rightarrow 3+}f(x) = b$$

이때의 우극한은 $b$ 입니다.

### 극한의 존재 조건

<font color="#ffff00">극한값이 존재할 조건은 우극한과 좌극한이 같아야 합니다</font>. 즉 $\lim_{x \rightarrow a-}f(x)$ =  $\lim_{x \rightarrow a+}f(x)$ = $a$ 이면  $\lim_{x \rightarrow a}f(x) = a$ 입니다.

