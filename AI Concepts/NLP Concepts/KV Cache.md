
## KV Cache Explained

`KV Cache` 는 [[Transformer]] 디코더에서 key 와 value 를 **한 번 계산해 저장하고 재사용하는 구조**입니다. 이를 통해 텍스트 생성에서 **속도와 효율성을 향상** 시킵니다.

- key와 value : 이전 입력에서 계산된 후 변하지 않으며, KV Cache에 저장되어 재사용됩니다.
- Query : 현재 입력 토큰에서 매번 새로 계산됩니다.

## Example

"고양이가 박스에 앉아있다."

| 시점    | 현재 토큰 | Query     | Key/value (캐시에 저장) |
| ----- | ----- | --------- | ------------------ |
| $t=1$ | 고     | "고" 에서 생성 | "고"                |
| $t=2$ | 양     | "양" 에서 생성 | "고","양"            |
| $t=3$ | 이     | "이" 에서 생성 | "고","양","이"        |
| $t=4$ | 가     | "가" 에서 생성 | "고","양","이","가"    |
| ...   | ...   | ...       | ...(계속 누적)         |

각 시점에서

- query 는 현재 토큰에서 계속 생성됩니다.
- key와 value는 계산 후 캐시에 저장됩니다.
- 디코더는 현재 query 와 캐시된 key/value 를 사용해 다음 토큰을 예측합니다.

